<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#00ff66">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="NEXCHAT Ads">
  <meta name="format-detection" content="telephone=no">
  <title>NEXCHAT - Marketplace</title>
  <link rel="stylesheet" href="advertisement.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="logo.jpg">
  <link rel="apple-touch-icon" href="logo.jpg">
</head>

<body>
  <div class="app">
    <!-- TOP HEADER BAR -->
    <header class="top-header">
      <div class="header-left">
        <button id="backBtn" class="back-button" title="Back to Chat">â† </button>
        <div class="nex-logo" id="headerLogoImg" style="cursor: pointer;" onclick="window.location.href='chat.html'">
          <span class="nex-text">NEXCHAT</span>
          <span
            style="font-family: 'Rajdhani', sans-serif; font-size: 14px; color: #888; margin-left: 5px; letter-spacing: 1px;">MARKETPLACE</span>
        </div>
      </div>
      <div class="header-center">
        <div id="cartBadge" class="cart-badge" title="Items in cart">
          <span class="badge-icon">ğŸ›’</span>
          <span id="cartCount" class="badge-count">0</span>
        </div>
      </div>
      <div class="header-right-scroll">
        <div class="header-right">
          <button id="cartBtn" class="header-icon-btn" title="View Cart">ğŸ›’</button>
          <button id="searchBtn" class="header-icon-btn" title="Search Ads">ğŸ”</button>
          <button id="myAdsBtn" class="header-icon-btn" title="My Advertisements">ğŸ“</button>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="ads-main">
      <!-- UPLOAD AD SECTION -->
      <section class="upload-ad-section" id="uploadSection">
        <div class="upload-header">
          <h2>ğŸ“¦ Post Your Advertisement</h2>
          <p>Share your products with NEXCHAT users</p>
        </div>

        <form id="adForm" class="ad-form">
          <!-- Product Image -->
          <div class="form-group">
            <label for="productImage">ğŸ“¸ Product Image</label>
            <div class="image-upload-area" id="imageUploadArea">
              <input type="file" id="productImage" accept="image/*" required style="display: none;">
              <div class="upload-placeholder">
                <span class="upload-icon">ğŸ–¼ï¸</span>
                <p>Click to upload image</p>
                <small>JPG, PNG, GIF (Max 5MB)</small>
              </div>
            </div>
            <div id="imagePreview" class="image-preview" style="display: none;">
              <img id="previewImg" src="" alt="Preview">
              <button type="button" class="remove-image-btn" id="removeImageBtn">âœ•</button>
            </div>
          </div>

          <!-- Product Name -->
          <div class="form-group">
            <label for="productName">ğŸ“› Product Name</label>
            <input type="text" id="productName" placeholder="e.g., iPhone 15 Pro" maxlength="100" required>
          </div>

          <!-- Product Description -->
          <div class="form-group">
            <label for="productDescription">ğŸ“ Description</label>
            <textarea id="productDescription" placeholder="Describe your product..." maxlength="500"
              rows="4"></textarea>
          </div>

          <!-- Product Price -->
          <div class="form-group">
            <label for="productPrice">ğŸ’° Price (USD)</label>
            <input type="number" id="productPrice" placeholder="0.00" min="0" step="0.01" required>
          </div>

          <!-- Category -->
          <div class="form-group">
            <label for="productCategory">ğŸ“‚ Category</label>
            <select id="productCategory" required>
              <option value="">Select a category</option>
              <option value="electronics">ğŸ–¥ï¸ Electronics</option>
              <option value="clothing">ğŸ‘• Clothing</option>
              <option value="books">ğŸ“š Books</option>
              <option value="sports">âš½ Sports</option>
              <option value="furniture">ğŸª‘ Furniture</option>
              <option value="food">ğŸ” Food & Beverages</option>
              <option value="services">ğŸ› ï¸ Services</option>
              <option value="other">ğŸ“¦ Other</option>
            </select>
          </div>

          <!-- Duration Plan -->
          <div class="form-group">
            <label for="durationPlan">â±ï¸ Advertisement Duration</label>
            <div class="duration-options">
              <div class="duration-option">
                <input type="radio" id="plan48" name="durationPlan" value="48" checked>
                <label for="plan48" class="duration-label">
                  <span class="duration-time">48 Hours</span>
                  <span class="duration-price">â­ 100 Tokens</span>
                </label>
              </div>
              <div class="duration-option">
                <input type="radio" id="plan72" name="durationPlan" value="72">
                <label for="plan72" class="duration-label">
                  <span class="duration-time">72 Hours</span>
                  <span class="duration-price">â­ 150 Tokens</span>
                </label>
              </div>
              <div class="duration-option">
                <input type="radio" id="plan144" name="durationPlan" value="144">
                <label for="plan144" class="duration-label">
                  <span class="duration-time">144 Hours (6 Days)</span>
                  <span class="duration-price">â­ 300 Tokens</span>
                </label>
              </div>
              <div class="duration-option">
                <input type="radio" id="plan168" name="durationPlan" value="168">
                <label for="plan168" class="duration-label">
                  <span class="duration-time">168 Hours (7 Days)</span>
                  <span class="duration-price">â­ 350 Tokens</span>
                </label>
              </div>
            </div>
            <div id="tokenWarning" class="token-warning" style="display: none;"></div>
          </div>

          <!-- Contact Information (Auto-filled) -->
          <div class="contact-section">
            <h3>ğŸ“ Your Contact Information</h3>
            <div class="form-group">
              <label for="nexUsername">NEX Username</label>
              <input type="text" id="nexUsername" placeholder="Your NEX username" readonly>
            </div>
            <div class="form-group">
              <label for="userEmail">ğŸ“§ Email</label>
              <input type="email" id="userEmail" placeholder="Your email" readonly>
            </div>
            <div class="form-group">
              <label for="userUID">User ID (UID)</label>
              <input type="text" id="userUID" placeholder="Your UID" readonly>
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="btn-primary post-ad-btn">ğŸš€ Post Advertisement</button>
          <div id="uploadStatus" class="status-message" style="display: none;"></div>
        </form>
      </section>

      <!-- ADVERTISEMENTS LIST VIEW -->
      <section class="ads-list-section" id="adsListSection" style="display: none;">
        <div class="list-header">
          <h2>ğŸ›ï¸ Available Products</h2>
          <div class="view-controls">
            <button id="gridViewBtn" class="view-btn active" title="Grid View">âŠ</button>
            <button id="listViewBtn" class="view-btn" title="List View">â‰¡</button>
          </div>
        </div>

        <!-- Search & Filter -->
        <div class="search-filter-area">
          <input type="text" id="searchAds" class="search-input" placeholder="Search products...">
          <select id="filterCategory" class="filter-select">
            <option value="">All Categories</option>
            <option value="electronics">ğŸ–¥ï¸ Electronics</option>
            <option value="clothing">ğŸ‘• Clothing</option>
            <option value="books">ğŸ“š Books</option>
            <option value="sports">âš½ Sports</option>
            <option value="furniture">ğŸª‘ Furniture</option>
            <option value="food">ğŸ” Food & Beverages</option>
            <option value="services">ğŸ› ï¸ Services</option>
            <option value="other">ğŸ“¦ Other</option>
          </select>
        </div>

        <!-- Ads Grid/List -->
        <div id="adsList" class="ads-grid">
          <div class="empty-state">
            <p>ğŸ“­ No advertisements yet</p>
            <p class="hint">Be the first to post!</p>
          </div>
        </div>
      </section>

      <!-- MY ADVERTISEMENTS VIEW -->
      <section class="my-ads-section" id="myAdsSection" style="display: none;">
        <div class="section-header">
          <h2>ğŸ“ My Advertisements</h2>
          <button id="createNewAdBtn" class="btn-primary">â• New Ad</button>
        </div>

        <div id="myAdsList" class="ads-grid">
          <div class="empty-state">
            <p>ğŸ“­ No advertisements yet</p>
            <p class="hint">Create your first advertisement</p>
          </div>
        </div>
      </section>

      <!-- CART VIEW -->
      <section class="cart-section" id="cartSection" style="display: none;">
        <div class="section-header">
          <h2>ğŸ›’ Shopping Cart</h2>
        </div>

        <div id="cartItems" class="cart-items-list">
          <div class="empty-state">
            <p>ğŸ›’ Your cart is empty</p>
            <p class="hint">Add items to get started</p>
          </div>
        </div>

        <div id="cartSummary" class="cart-summary" style="display: none;">
          <div class="summary-row">
            <span>Subtotal:</span>
            <span id="subtotal">$0.00</span>
          </div>
          <div class="summary-row">
            <span>Tax (10%):</span>
            <span id="taxAmount">$0.00</span>
          </div>
          <div class="summary-row total">
            <span>Total:</span>
            <span id="totalAmount">$0.00</span>
          </div>

          <div class="cart-actions">
            <button id="checkoutBtn" class="btn-primary">ğŸ’³ Proceed to Checkout</button>
            <button id="continueShopping" class="btn-secondary">ğŸ›ï¸ Continue Shopping</button>
          </div>
        </div>
      </section>

      <!-- AD DETAIL VIEW -->
      <section class="ad-detail-section" id="adDetailSection" style="display: none;">
        <button id="backFromDetailBtn" class="back-button-detail">â€¹ Back</button>

        <div class="ad-detail-container">
          <!-- Product Image -->
          <div class="detail-image-container">
            <img id="detailImage" src="" alt="Product">
            <div class="detail-category-badge" id="detailCategoryBadge"></div>
          </div>

          <!-- Product Info -->
          <div class="detail-info">
            <h2 id="detailName">Product Name</h2>
            <p id="detailDescription" class="detail-description"></p>

            <div class="detail-price">
              <span class="price-label">Price:</span>
              <span class="price-value" id="detailPrice">$0.00</span>
            </div>

            <div class="detail-category">
              <span class="category-label">Category:</span>
              <span class="category-value" id="detailCategory"></span>
            </div>

            <!-- Seller Info -->
            <div class="seller-info">
              <h3>ğŸ‘¤ Seller Information</h3>
              <div class="seller-details">
                <p><strong>Username:</strong> <span id="detailUsername"></span></p>
                <p><strong>Email:</strong> <span id="detailEmail"></span></p>
                <p><strong>UID:</strong> <span id="detailUID"></span></p>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="detail-actions">
              <button id="addToCartDetailBtn" class="btn-primary">ğŸ›’ Add to Cart</button>
              <button id="contactSellerBtn" class="btn-secondary">ğŸ’¬ Contact Seller</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- NOTIFICATION CONTAINER -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- OFFLINE INDICATOR -->
    <div id="offlineIndicator" class="offline-indicator" style="display: none;">
      <span class="offline-icon">ğŸ“µ</span>
      <span class="offline-text">You are offline</span>
    </div>
  </div>

  <!-- Firebase Scripts -->
  <script type="module" src="advertisement.js"></script>
</body>

</html>